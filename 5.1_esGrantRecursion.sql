SELECT GRANTEE
FROM SYSCAT.SCHEMAAUTH
WHERE SCHEMANAME = 'A0974745';

GRANT CREATEIN, ALTERIN, DROPIN
ON SCHEMA A0974745
TO USER A0978068;

REVOKE CREATEIN, ALTERIN, DROPIN
ON SCHEMA A0974745
FROM USER A0978068;

CREATE TABLE A0978068.FILM (
	TITOLO VARCHAR(50) PRIMARY KEY NOT NULL,
	ANNO INT,
	PROTAGONISTA VARCHAR(50)
);

SELECT * FROM A0978068.FILM;
SELECT * FROM A0974745.ATTORE;

DROP TABLE A0978068.FILM;

-- 3) aggiunta parametri 
ALTER TABLE A0978068.FILM ALTER COLUMN ANNO SET NOT NULL;
ALTER TABLE A0978068.FILM ALTER COLUMN PROTAGONISTA SET NOT NULL;

ALTER TABLE A0974745.ATTORE ADD CONSTRAINT FK_FilmDebutto FOREIGN KEY (filmdebutto) REFERENCES A0978068.FILM;
CALL SYSPROC.ADMIN_CMD('REORG TABLE A0978068.FILM');

-- 2) inserimento valori nel proprio schema tramite autorizzazione concessa dal compagno
GRANT ALL
ON TABLE A0978068.FILM
TO USER A0978068;

INSERT INTO A0974745.ATTORE VALUES 
('ARON KWOCK', 1965, 'China strike force'),
('Samuel Jumps', 1961, 'Reti Logiche'),
('John Travolta', 1948, 'Grease'),
('Tommaso Sgreccia', 2001, 'I Maledetti'),
('Alessandro', 1993, 'I Maledetti'),
('Bruce Lee', 1940, 'L investigatore Marlowe'),
('Edenti', 1950, 'Java The New World'),
('Borghesi', 1971, 'The lab rat2');



-- 5) aggiunta vista
CREATE OR REPLACE VIEW A0974745.PROTAGONISTI(ATTORE,ANNONASCITA,NUMFILM)
AS (SELECT a.nome, a.ANNONASCITA, COUNT(a.nome) 
	FROM A0974745.ATTORE a JOIN A0978068.FILM f ON (a.nome = f.protagonista)
	GROUP BY a.nome, a.ANNONASCITA);


-- PARTE 2)
INSERT INTO B16884.CASCATA VALUES ('AleAlleg', CURRENT USER);

SELECT * FROM B16884.CASCATA c;

GRANT CREATEIN, ALTERIN, DROPIN 
ON SCHEMA A0974745
TO USER A0978100, A0978980, A0997614;

GRANT CREATEIN, ALTERIN, DROPIN 
ON SCHEMA A0974745
TO USER A0974868, A0975183
WITH GRANT OPTION;


-- v1) chi sono gli username che, direttamente o indirettamente, gli hanno dato il GRANT, e a che “distanza minima” da lui sono



















